{% extends "emails/base.html" %}

{% block title %}New Contact Message - {{ site_name }} Admin{% endblock %}

{% block content %}
<h1>ðŸ“¨ New Contact Message Received</h1>

<p>A new contact message has been submitted through the {{ site_name }} website and requires your attention.</p>

<div class="highlight">
    <h2>ðŸ“‹ Message Details</h2>
    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold; width: 120px;">Message ID:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">#{{ message.id }}</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold;">From:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">{{ message.name }} ({{ message.email }})</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold;">Subject:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">{{ message.subject }}</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold;">Priority:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">
                <span style="background-color: {% if message.priority == 'urgent' %}#dc2626{% elif message.priority == 'high' %}#ef4444{% elif message.priority == 'medium' %}#f59e0b{% else %}#10b981{% endif %}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: bold;">
                    {{ message.get_priority_display }}
                </span>
            </td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold;">Received:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">{{ message.created_at|date:"F d, Y \a\t g:i A" }}</td>
        </tr>
        {% if message.user %}
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold;">User Account:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">{{ message.user.get_full_name }} ({{ message.user.role }})</td>
        </tr>
        {% endif %}
        {% if message.ip_address %}
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; font-weight: bold;">IP Address:</td>
            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">{{ message.ip_address }}</td>
        </tr>
        {% endif %}
    </table>
</div>

<div style="background: #f7fafc; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; margin: 20px 0;">
    <h3 style="margin-top: 0; color: #4a5568;">Message Content:</h3>
    <div style="background: white; padding: 15px; border-radius: 6px; color: #2d3748; line-height: 1.6;">
        {{ message.message|linebreaks }}
    </div>
</div>

{% if message.attachments.exists %}
<div class="highlight">
    <h3>ðŸ“Ž Attachments ({{ message.attachments.count }})</h3>
    <ul style="margin-left: 20px; margin-top: 10px;">
        {% for attachment in message.attachments.all %}
        <li>
            <strong>{{ attachment.original_filename }}</strong> 
            ({{ attachment.file_size_formatted }}, {{ attachment.content_type }})
        </li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<div class="divider"></div>

<h2>ðŸŽ¯ Quick Actions</h2>
<div style="text-align: center; margin: 30px 0;">
    <a href="{{ admin_url }}" class="button" style="margin-right: 10px;">
        View & Respond in Admin
    </a>
    <a href="mailto:{{ message.email }}?subject=Re: {{ message.subject }}" 
       style="display: inline-block; background: #10b981; color: white; padding: 15px 30px; text-decoration: none; border-radius: 8px; font-weight: bold; margin-left: 10px;">
        Reply via Email
    </a>
</div>

<div class="warning">
    <p><strong>Response Time Target:</strong> 
        {% if message.priority == 'urgent' %}
            Respond within 2 hours
        {% elif message.priority == 'high' %}
            Respond within 4 hours
        {% elif message.priority == 'medium' %}
            Respond within 24 hours
        {% else %}
            Respond within 48 hours
        {% endif %}
    </p>
</div>

<div class="divider"></div>

<h2>ðŸ“Š Recent Activity Summary</h2>
<p>This notification was automatically generated by the {{ site_name }} contact system. Check the admin dashboard for more contact message statistics and trends.</p>

<p>Best regards,<br><strong>{{ site_name }} System</strong></p>
{% endblock %}